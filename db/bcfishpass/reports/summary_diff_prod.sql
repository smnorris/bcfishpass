-- compare current data to current data in foreign database

create view bcfishpass.wsg_crossing_summary_diff_prod as
select
  a.watershed_group_code                  ,
  a.crossing_feature_type                 ,
  a.n_crossings_total                     - b.n_crossings_total as n_crossings_total,
  a.n_passable_total                      - b.n_passable_total as n_passable_total,
  a.n_barriers_total                      - b.n_barriers_total as n_barriers_total,
  a.n_potential_total                     - b.n_potential_total as n_potential_total,
  a.n_unknown_total                       - b.n_unknown_total as n_unknown_total,
  a.n_barriers_accessible_bt              - b.n_barriers_accessible_bt as n_barriers_accessible_bt,
  a.n_potential_accessible_bt             - b.n_potential_accessible_bt as n_potential_accessible_bt,
  a.n_unknown_accessible_bt               - b.n_unknown_accessible_bt as n_unknown_accessible_bt,
  a.n_barriers_accessible_ch_cm_co_pk_sk  - b.n_barriers_accessible_ch_cm_co_pk_sk as n_barriers_accessible_ch_cm_co_pk_sk,
  a.n_potential_accessible_ch_cm_co_pk_sk - b.n_potential_accessible_ch_cm_co_pk_sk as n_potential_accessible_ch_cm_co_pk_sk,
  a.n_unknown_accessible_ch_cm_co_pk_sk   - b.n_unknown_accessible_ch_cm_co_pk_sk as n_unknown_accessible_ch_cm_co_pk_sk,
  a.n_barriers_accessible_st              - b.n_barriers_accessible_st as n_barriers_accessible_st,
  a.n_potential_accessible_st             - b.n_potential_accessible_st as n_potential_accessible_st,
  a.n_unknown_accessible_st               - b.n_unknown_accessible_st as n_unknown_accessible_st,
  a.n_barriers_accessible_wct             - b.n_barriers_accessible_wct as n_barriers_accessible_wct,
  a.n_potential_accessible_wct            - b.n_potential_accessible_wct as n_potential_accessible_wct,
  a.n_unknown_accessible_wct              - b.n_unknown_accessible_wct as n_unknown_accessible_wct,
  a.n_barriers_habitat_bt                 - b.n_barriers_habitat_bt as n_barriers_habitat_bt,
  a.n_potential_habitat_bt                - b.n_potential_habitat_bt as n_potential_habitat_bt,
  a.n_unknown_habitat_bt                  - b.n_unknown_habitat_bt as n_unknown_habitat_bt,
  a.n_barriers_habitat_ch                 - b.n_barriers_habitat_ch as n_barriers_habitat_ch,
  a.n_potential_habitat_ch                - b.n_potential_habitat_ch as n_potential_habitat_ch,
  a.n_unknown_habitat_ch                  - b.n_unknown_habitat_ch as n_unknown_habitat_ch,
  a.n_barriers_habitat_cm                 - b.n_barriers_habitat_cm as n_barriers_habitat_cm,
  a.n_potential_habitat_cm                - b.n_potential_habitat_cm as n_potential_habitat_cm,
  a.n_unknown_habitat_cm                  - b.n_unknown_habitat_cm as n_unknown_habitat_cm,
  a.n_barriers_habitat_co                 - b.n_barriers_habitat_co as n_barriers_habitat_co,
  a.n_potential_habitat_co                - b.n_potential_habitat_co as n_potential_habitat_co,
  a.n_unknown_habitat_co                  - b.n_unknown_habitat_co as n_unknown_habitat_co,
  a.n_barriers_habitat_pk                 - b.n_barriers_habitat_pk as n_barriers_habitat_pk,
  a.n_potential_habitat_pk                - b.n_potential_habitat_pk as n_potential_habitat_pk,
  a.n_unknown_habitat_pk                  - b.n_unknown_habitat_pk as n_unknown_habitat_pk,
  a.n_barriers_habitat_sk                 - b.n_barriers_habitat_sk as n_barriers_habitat_sk,
  a.n_potential_habitat_sk                - b.n_potential_habitat_sk as n_potential_habitat_sk,
  a.n_unknown_habitat_sk                  - b.n_unknown_habitat_sk as n_unknown_habitat_sk,
  a.n_barriers_habitat_salmon             - b.n_barriers_habitat_salmon as n_barriers_habitat_salmon,
  a.n_potential_habitat_salmon            - b.n_potential_habitat_salmon as n_potential_habitat_salmon,
  a.n_unknown_habitat_salmon              - b.n_unknown_habitat_salmon as n_unknown_habitat_salmon,
  a.n_barriers_habitat_st                 - b.n_barriers_habitat_st as n_barriers_habitat_st,
  a.n_potential_habitat_st                - b.n_potential_habitat_st as n_potential_habitat_st,
  a.n_unknown_habitat_st                  - b.n_unknown_habitat_st as n_unknown_habitat_st,
  a.n_barriers_habitat_wct                - b.n_barriers_habitat_wct as n_barriers_habitat_wct,
  a.n_potential_habitat_wct               - b.n_potential_habitat_wct as n_potential_habitat_wct,
  a.n_unknown_habitat_wct                - b.n_unknown_habitat_wct as n_unknown_habitat_wct
from bcfishpass.wsg_crossing_summary_current a
inner join bcfishpass_prod.wsg_crossing_summary_current b
  on a.watershed_group_code = b.watershed_group_code
  and a.crossing_feature_type = b.crossing_feature_type
order by a.watershed_group_code;

create view bcfishpass.wsg_linear_summary_diff_prod as
select
  a.watershed_group_code                                     ,
  a.length_total                                             - b.length_total                                             as length_total,
  a.length_potentiallyaccessible_bt                          - b.length_potentiallyaccessible_bt                          as length_potentiallyaccessible_bt,
  a.length_potentiallyaccessible_bt_observed                 - b.length_potentiallyaccessible_bt_observed                 as length_potentiallyaccessible_bt_observed,
  a.length_potentiallyaccessible_bt_accessible_a             - b.length_potentiallyaccessible_bt_accessible_a             as length_potentiallyaccessible_bt_accessible_a,
  a.length_potentiallyaccessible_bt_accessible_b             - b.length_potentiallyaccessible_bt_accessible_b             as length_potentiallyaccessible_bt_accessible_b,
  a.length_obsrvd_spawning_rearing_bt                        - b.length_obsrvd_spawning_rearing_bt                        as length_obsrvd_spawning_rearing_bt,
  a.length_obsrvd_spawning_rearing_bt_accessible_a           - b.length_obsrvd_spawning_rearing_bt_accessible_a           as length_obsrvd_spawning_rearing_bt_accessible_a,
  a.length_obsrvd_spawning_rearing_bt_accessible_b           - b.length_obsrvd_spawning_rearing_bt_accessible_b           as length_obsrvd_spawning_rearing_bt_accessible_b,
  a.length_spawning_rearing_bt                               - b.length_spawning_rearing_bt                               as length_spawning_rearing_bt,
  a.length_spawning_rearing_bt_accessible_a                  - b.length_spawning_rearing_bt_accessible_a                  as length_spawning_rearing_bt_accessible_a,
  a.length_spawning_rearing_bt_accessible_b                  - b.length_spawning_rearing_bt_accessible_b                  as length_spawning_rearing_bt_accessible_b,
  a.length_potentiallyaccessible_ch_cm_co_pk_sk              - b.length_potentiallyaccessible_ch_cm_co_pk_sk              as length_potentiallyaccessible_ch_cm_co_pk_sk,
  a.length_potentiallyaccessible_ch_cm_co_pk_sk_observed     - b.length_potentiallyaccessible_ch_cm_co_pk_sk_observed     as length_potentiallyaccessible_ch_cm_co_pk_sk_observed,
  a.length_potentiallyaccessible_ch_cm_co_pk_sk_accessible_a - b.length_potentiallyaccessible_ch_cm_co_pk_sk_accessible_a as length_potentiallyaccessible_ch_cm_co_pk_sk_accessible_a,
  a.length_potentiallyaccessible_ch_cm_co_pk_sk_accessible_b - b.length_potentiallyaccessible_ch_cm_co_pk_sk_accessible_b as length_potentiallyaccessible_ch_cm_co_pk_sk_accessible_b,
  a.length_obsrvd_spawning_rearing_ch                        - b.length_obsrvd_spawning_rearing_ch                        as length_obsrvd_spawning_rearing_ch,
  a.length_obsrvd_spawning_rearing_ch_accessible_a           - b.length_obsrvd_spawning_rearing_ch_accessible_a           as length_obsrvd_spawning_rearing_ch_accessible_a,
  a.length_obsrvd_spawning_rearing_ch_accessible_b           - b.length_obsrvd_spawning_rearing_ch_accessible_b           as length_obsrvd_spawning_rearing_ch_accessible_b,
  a.length_spawning_rearing_ch                               - b.length_spawning_rearing_ch                               as length_spawning_rearing_ch,
  a.length_spawning_rearing_ch_accessible_a                  - b.length_spawning_rearing_ch_accessible_a                  as length_spawning_rearing_ch_accessible_a,
  a.length_spawning_rearing_ch_accessible_b                  - b.length_spawning_rearing_ch_accessible_b                  as length_spawning_rearing_ch_accessible_b,
  a.length_obsrvd_spawning_rearing_cm                        - b.length_obsrvd_spawning_rearing_cm                        as length_obsrvd_spawning_rearing_cm,
  a.length_obsrvd_spawning_rearing_cm_accessible_a           - b.length_obsrvd_spawning_rearing_cm_accessible_a           as length_obsrvd_spawning_rearing_cm_accessible_a,
  a.length_obsrvd_spawning_rearing_cm_accessible_b           - b.length_obsrvd_spawning_rearing_cm_accessible_b           as length_obsrvd_spawning_rearing_cm_accessible_b,
  a.length_spawning_rearing_cm                               - b.length_spawning_rearing_cm                               as length_spawning_rearing_cm,
  a.length_spawning_rearing_cm_accessible_a                  - b.length_spawning_rearing_cm_accessible_a                  as length_spawning_rearing_cm_accessible_a,
  a.length_spawning_rearing_cm_accessible_b                  - b.length_spawning_rearing_cm_accessible_b                  as length_spawning_rearing_cm_accessible_b,
  a.length_obsrvd_spawning_rearing_co                        - b.length_obsrvd_spawning_rearing_co                        as length_obsrvd_spawning_rearing_co,
  a.length_obsrvd_spawning_rearing_co_accessible_a           - b.length_obsrvd_spawning_rearing_co_accessible_a           as length_obsrvd_spawning_rearing_co_accessible_a,
  a.length_obsrvd_spawning_rearing_co_accessible_b           - b.length_obsrvd_spawning_rearing_co_accessible_b           as length_obsrvd_spawning_rearing_co_accessible_b,
  a.length_spawning_rearing_co                               - b.length_spawning_rearing_co                               as length_spawning_rearing_co,
  a.length_spawning_rearing_co_accessible_a                  - b.length_spawning_rearing_co_accessible_a                  as length_spawning_rearing_co_accessible_a,
  a.length_spawning_rearing_co_accessible_b                  - b.length_spawning_rearing_co_accessible_b                  as length_spawning_rearing_co_accessible_b,
  a.length_obsrvd_spawning_rearing_pk                        - b.length_obsrvd_spawning_rearing_pk                        as length_obsrvd_spawning_rearing_pk,
  a.length_obsrvd_spawning_rearing_pk_accessible_a           - b.length_obsrvd_spawning_rearing_pk_accessible_a           as length_obsrvd_spawning_rearing_pk_accessible_a,
  a.length_obsrvd_spawning_rearing_pk_accessible_b           - b.length_obsrvd_spawning_rearing_pk_accessible_b           as length_obsrvd_spawning_rearing_pk_accessible_b,
  a.length_spawning_rearing_pk                               - b.length_spawning_rearing_pk                               as length_spawning_rearing_pk,
  a.length_spawning_rearing_pk_accessible_a                  - b.length_spawning_rearing_pk_accessible_a                  as length_spawning_rearing_pk_accessible_a,
  a.length_spawning_rearing_pk_accessible_b                  - b.length_spawning_rearing_pk_accessible_b                  as length_spawning_rearing_pk_accessible_b,
  a.length_obsrvd_spawning_rearing_sk                        - b.length_obsrvd_spawning_rearing_sk                        as length_obsrvd_spawning_rearing_sk,
  a.length_obsrvd_spawning_rearing_sk_accessible_a           - b.length_obsrvd_spawning_rearing_sk_accessible_a           as length_obsrvd_spawning_rearing_sk_accessible_a,
  a.length_obsrvd_spawning_rearing_sk_accessible_b           - b.length_obsrvd_spawning_rearing_sk_accessible_b           as length_obsrvd_spawning_rearing_sk_accessible_b,
  a.length_spawning_rearing_sk                               - b.length_spawning_rearing_sk                               as length_spawning_rearing_sk,
  a.length_spawning_rearing_sk_accessible_a                  - b.length_spawning_rearing_sk_accessible_a                  as length_spawning_rearing_sk_accessible_a,
  a.length_spawning_rearing_sk_accessible_b                  - b.length_spawning_rearing_sk_accessible_b                  as length_spawning_rearing_sk_accessible_b,
  a.length_potentiallyaccessible_st                          - b.length_potentiallyaccessible_st                          as length_potentiallyaccessible_st,
  a.length_potentiallyaccessible_st_observed                 - b.length_potentiallyaccessible_st_observed                 as length_potentiallyaccessible_st_observed,
  a.length_potentiallyaccessible_st_accessible_a             - b.length_potentiallyaccessible_st_accessible_a             as length_potentiallyaccessible_st_accessible_a,
  a.length_potentiallyaccessible_st_accessible_b             - b.length_potentiallyaccessible_st_accessible_b             as length_potentiallyaccessible_st_accessible_b,
  a.length_obsrvd_spawning_rearing_st                        - b.length_obsrvd_spawning_rearing_st                        as length_obsrvd_spawning_rearing_st,
  a.length_obsrvd_spawning_rearing_st_accessible_a           - b.length_obsrvd_spawning_rearing_st_accessible_a           as length_obsrvd_spawning_rearing_st_accessible_a,
  a.length_obsrvd_spawning_rearing_st_accessible_b           - b.length_obsrvd_spawning_rearing_st_accessible_b           as length_obsrvd_spawning_rearing_st_accessible_b,
  a.length_spawning_rearing_st                               - b.length_spawning_rearing_st                               as length_spawning_rearing_st,
  a.length_spawning_rearing_st_accessible_a                  - b.length_spawning_rearing_st_accessible_a                  as length_spawning_rearing_st_accessible_a,
  a.length_spawning_rearing_st_accessible_b                  - b.length_spawning_rearing_st_accessible_b                  as length_spawning_rearing_st_accessible_b,
  a.length_potentiallyaccessible_wct                         - b.length_potentiallyaccessible_wct                         as length_potentiallyaccessible_wct,
  a.length_potentiallyaccessible_wct_observed                - b.length_potentiallyaccessible_wct_observed                as length_potentiallyaccessible_wct_observed,
  a.length_potentiallyaccessible_wct_accessible_a            - b.length_potentiallyaccessible_wct_accessible_a            as length_potentiallyaccessible_wct_accessible_a,
  a.length_potentiallyaccessible_wct_accessible_b            - b.length_potentiallyaccessible_wct_accessible_b            as length_potentiallyaccessible_wct_accessible_b,
  a.length_obsrvd_spawning_rearing_wct                       - b.length_obsrvd_spawning_rearing_wct                       as length_obsrvd_spawning_rearing_wct,
  a.length_obsrvd_spawning_rearing_wct_accessible_a          - b.length_obsrvd_spawning_rearing_wct_accessible_a          as length_obsrvd_spawning_rearing_wct_accessible_a,
  a.length_obsrvd_spawning_rearing_wct_accessible_b          - b.length_obsrvd_spawning_rearing_wct_accessible_b          as length_obsrvd_spawning_rearing_wct_accessible_b,
  a.length_spawning_rearing_wct                              - b.length_spawning_rearing_wct                              as length_spawning_rearing_wct,
  a.length_spawning_rearing_wct_accessible_a                 - b.length_spawning_rearing_wct_accessible_a                 as length_spawning_rearing_wct_accessible_a,
  a.length_spawning_rearing_wct_accessible_b                 - b.length_spawning_rearing_wct_accessible_b                 as length_spawning_rearing_wct_accessible_b
from bcfishpass.wsg_linear_summary_current a
inner join bcfishpass_prod.wsg_linear_summary_current b
on a.watershed_group_code = b.watershed_group_code
order by a.watershed_group_code;